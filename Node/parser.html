<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Parser test</title>
    <script src="parser.js"></script>
    <script>
var str = 'query=xpath';

var testing = new Parser(
    {
        parameter: $(['attribute', 'LWSP', '=', 'LWSP', 'value'], $('abc'), /abc/i),
        attribute: 'query',
        /**
        attribute: 'query2',
        query2: 'query',
        // query2: 'query2', // to throw error
        //*/
        LWSP: /\s*/,
        value: 'xpath'
    }
);

/**
// Working
var b = [];
testing.parse(str, 'parameter', null, null, null, function (prop, match, idx, isAggregate, useStringProperty, hasAlias, isAlias) {
    //if (prop !== this.startProperty) { // works to avoid largest aggregate
//    alert(prop +'::'+ match+'::'+ idx+'::'+ isAggregate+'::'+ useStringProperty+'::'+ hasAlias+'::'+ isAlias);

    if (!isAggregate &&
        // !hasAlias) { // Get the deferenced item
        !isAlias) { // Get the initial referencing item instead of dereferenced
        b.push(prop);
    }
});
alert(b.join());
throw 'exit';
//*/

testing.parse(str, 'parameter', {
    'parameter': function (att, level) {
        alert('parameter:' + att + ':' + level);
    },
    'attribute': function (att, level) {
        alert('attribute:' + att + ':' + level);
    },
    'value': function (val, level) {
        alert('value:' + val + ':' + level);
    },
    /*'LWSP': function (val, level) {
        alert('LWSP:' + val + ':' + level);
    },*/
    '=': function (val, level) {
        alert('equals:' + val + ':' + level);
    }
});

    </script>
</head>
<body>

<!--
<h1>Parser test</h1>
-->

</body>
</html>
